# プロモード限定メタデータプレビュー（折りたたみ）実装計画

## 1. 目的
- 読み込んだ画像にメタデータがある場合、プロモード時のみ確認できるUIを提供する。
- 簡易モードでは情報を出さず、操作負荷を増やさない。

## 2. 仕様
1. 表示条件:
   - `ui_mode == pro` のときのみ表示。
2. 表示形式:
   - 折りたたみパネル（初期状態: 閉じる）。
3. 表示内容（第一段階）:
   - EXIF有無
   - EXIFタグ数
   - GPS有無
   - 主要タグ（存在時のみ）:
     - Artist
     - Copyright
     - DateTimeOriginal
     - UserComment
     - Make / Model（取得できる場合）

## 3. データ取得方針
1. 画像選択時に即全件解析はしない（UI応答性優先）。
2. 選択中ファイルのみ遅延取得し、結果を `ImageJob` と紐づけてキャッシュ。
3. 取得失敗はUIに「取得失敗（詳細はログ）」として非致命扱い。

## 4. 変更対象
1. `src/karuku_resizer/gui_app.py`
   - `ImageJob` にメタデータキャッシュ用フィールド追加（必要最小）
   - メタデータ取得ヘルパー追加
   - プロモード時のみ表示する折りたたみフレーム追加
   - `_on_select_change` / `_apply_ui_mode` 連動更新
2. （任意）`src/karuku_resizer/image_save_pipeline.py`
   - 既存の `preview_exif_plan` を表示補助に再利用可能か検証

## 5. UI挙動
1. 簡易モード:
   - メタデータパネルを非表示。
2. プロモード:
   - メタデータパネル表示。
   - 折りたたみを開いたときだけ詳細行を表示。
3. ファイル切替:
   - 新しい選択画像のメタデータへ更新。

## 6. 検証観点
1. EXIFあり/なし画像で表示差分が正しい。
2. GPS有無表示が正しい。
3. EXIF編集モードと干渉しない（表示は読み取り専用）。
4. 一括処理性能に影響しない（遅延取得で吸収）。
