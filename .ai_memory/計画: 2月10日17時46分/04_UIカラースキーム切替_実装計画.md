# UIカラースキーム切替（System/Light/Dark）実装計画

## 1. 目的
- ユーザーがGUI内から明示的にカラースキームを選択できるようにする。
- 再起動後も選択を復元する。

## 2. 仕様
1. 選択肢: `システム`, `ライト`, `ダーク`。
2. 配置: 設定ヘッダ（`詳細設定を表示` と `簡易/プロ` の近傍）。
3. 反映: 選択直後に `customtkinter.set_appearance_mode(...)` を実行。
4. 永続化: `karuku_settings.json` に `appearance_mode` を保存。

## 3. 変更対象
1. `src/karuku_resizer/gui_app.py`
   - 定数マッピング追加（表示ラベル <-> mode文字列）
   - `settings_header_frame` にスキーム選択UI追加
   - `_restore_settings` へ復元処理追加
   - `_save_current_settings` へ保存処理追加
   - 反映時にプレビュー再描画（Canvas背景/文字色更新）
2. （必要なら）`SettingsManager._default_settings()` に `appearance_mode: system` 追加

## 4. 実装ポイント
1. 既存tuple色はそのまま活用する。
2. Linuxで`system`がlight扱いになるケースがあり得るため、表示ラベルは「システム（OS準拠）」として扱う。
3. `set_appearance_mode` 実行後に:
   - ウィンドウの背景色再設定
   - `canvas_org`, `canvas_resz` の背景色更新
   - 選択中画像があれば `_draw_previews` 再描画

## 5. 受け入れ条件
1. UIで切替後、同一セッション内で見た目が即時変化する。
2. アプリ再起動後、直前の選択状態が復元される。
3. 既存機能（保存/一括保存/EXIF差分）が退行しない。
