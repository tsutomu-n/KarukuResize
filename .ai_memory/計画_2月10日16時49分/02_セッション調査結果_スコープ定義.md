# セッション調査結果とスコープ定義

## 1. セッションで確定した主要要求
1. GUIに CLI 相当の操作性を持たせる:
   - 品質指定（5刻み、最低値あり）
   - 出力形式指定（環境依存でAVIF含む）
   - ドライラン
   - 詳細ログ
2. EXIFの扱いを選べるようにする:
   - 元EXIF保持
   - 編集して付与
   - 全削除
3. GPS情報を個別に削除できるようにする。
4. 事務員でも使える導線を重視しつつ、プロ向け編集も可能にする。
5. 可能なら Windows 実行環境（.exe）でも機能が破綻しないこと。

## 2. セッション中に確認された事実（コードベース）

### 2.1 GUI側の現実装
- `src/karuku_resizer/gui_app.py` に以下が実装済み:
  - 出力形式選択（自動/JPEG/PNG/WEBP/AVIF）
  - 品質選択（5刻み）
  - ドライラン
  - 詳細ログ切替
  - EXIFモード（保持/編集/削除）
  - GPS削除
  - EXIF差分プレビュー
- 設定永続化は `karuku_settings.json` を介して実装済み。

### 2.2 保存パイプラインの現実装
- `src/karuku_resizer/image_save_pipeline.py`:
  - `SaveOptions` / `SaveResult` / `ExifEditValues` を定義。
  - `save_image()` がフォーマット別保存 + EXIF付与 + フォールバック保存を担当。
  - EXIF編集項目は現時点で4項目:
    - Artist
    - Copyright
    - UserComment
    - DateTimeOriginal

### 2.3 CLI側の現実装
- `src/karuku_resizer/resize_core.py` の引数:
  - `-q/--quality`
  - `-f/--format`
  - `--dry-run`
  - `-v/--verbose`（重ね掛け可）

## 3. セッション内で得た運用上の示唆
1. GUIの存在機能と、ユーザー体感の「使える/使えない」にギャップがある。
   - 表示されていても導線や挙動で迷う可能性がある。
2. .exe化自体は進められるが、GUIイベントや詳細設定導線は実機検証が必要。
3. ドキュメントと現行実装の差がある箇所があり、仕様参照はコード優先で行うべき。

## 4. 今回の記録で採用するスコープ

### 4.1 In Scope
1. GUIのモード分離（簡易モード/プロモード）
2. メタデータ編集項目の段階拡張
3. 保存処理の整合性（単体/一括/ドライラン）
4. 設定保存と復元の一貫性
5. テスト観点・受け入れ基準の整備

### 4.2 Out of Scope
1. レガシー実装の再評価や救済
2. アーカイブ資産の復元
3. 全形式での完全同等メタデータ編集保証
4. エンタープライズ規模前提の運用設計

## 5. セッション外既存情報の取り扱い方針
- 関連する既存情報のみ採用:
  - `README.md`
  - `pyproject.toml`
  - `docs/BUILDING.md` 等のビルド関連
  - 既存テスト
- 採用しない情報:
  - レガシー検証ログ
  - アーカイブ配下の設計メモ

## 6. 計画記録における制約
1. 事実と推論を混在させない。
2. 未確認事項は「未確認」と明記する。
3. 実装可能性は現行コード責務に沿って評価する。
