# 画像リサイズ・圧縮ツール

日本語ファイル名に対応した画像リサイズ・圧縮ツールです。指定されたディレクトリから画像ファイル(.jpg, .png)を検索し、指定された幅にリサイズして、圧縮率を指定してJPEG形式で保存します。

## 機能

- 横幅を指定してリサイズ（アスペクト比維持）
- JPEG圧縮率の調整
- 日本語ファイル名・フォルダ名対応
- ディレクトリ構造の維持
- ドライラン機能（変更前に処理内容を確認）
- 詳細なログ出力

## 前提条件

- Python 3.12以上
- 依存ライブラリ：Pillow, loguru

## インストール

```bash
# 仮想環境を作成・有効化
uv venv
.venv\Scripts\activate

# 依存ライブラリのインストール
uv pip install pillow loguru
```

## 使用方法

### 1. ディレクトリ構造

処理したい画像ファイルを `input` ディレクトリ内に配置します。

```
D:\tools\edit-img\
  ├─ input\            # 入力画像を配置するディレクトリ
  │   ├─ 山田太郎\     # 人物名ごとのフォルダ
  │   │   ├─ 足場.jpg   # 資格画像
  │   │   └─ クレーン.jpg
  │   ├─ 鈴木一郎\
  │   │   └─ ...
  │   └─ ...
  │
  ├─ output\           # 処理済み画像の出力先
  └─ resize_images.py  # 処理スクリプト
```

### 2. 基本的な使い方

```bash
python resize_images.py
```

### 3. ドライランモード（実際に変更を加えず、何が行われるかを確認）

```bash
python resize_images.py --dry-run
```

### 4. カスタム設定

```bash
# 横幅800px、JPEG品質90%で処理
python resize_images.py --width 800 --quality 90

# 詳細出力モード
python resize_images.py --verbose

# 入力・出力ディレクトリを指定
python resize_images.py --source "別のパス" --destination "別の出力先"
```

## オプション一覧

| オプション | 短縮形 | デフォルト値 | 説明 |
|----------|-------|------------|------|
| `--source` | `-s` | `./input` | 入力ディレクトリのパス |
| `--destination` | `-d` | `./output` | 出力先ディレクトリのパス |
| `--width` | `-w` | `1200` | リサイズする幅（ピクセル） |
| `--quality` | `-q` | `87` | JPEG品質（1-100） |
| `--dry-run` | なし | `False` | ドライラン実行（実際に変更しない） |
| `--verbose` | `-v` | `False` | 詳細出力モード |

## 処理結果

処理結果は `output` ディレクトリに保存され、元のディレクトリ構造が維持されます。

例：
- 入力：`input/山田太郎/足場.jpg`
- 出力：`output/山田太郎/足場.jpg`（リサイズ・圧縮済み）

## ログ

処理の詳細なログは `process_日付.log` ファイルに記録されます。エラーが発生した場合は、このログファイルを確認してください。

## 注意事項

- 大量の画像を処理する場合は、メモリ使用量に注意してください。
- 元のファイル名に使用できない文字（`\ / : * ? " < > |`）が含まれていた場合、エラーが発生する可能性があります。
- `.jpg`と`.jpeg`以外の拡張子を持つファイルは、`.jpg`に変換されます。
